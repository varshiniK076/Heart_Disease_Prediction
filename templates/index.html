<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Heart Disease Risk Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="container">
    <h1>❤️ Heart Disease Risk Prediction</h1>
    <p class="subtitle">Enter patient data (numeric values only)</p>

    <form id="predictionForm">
        <div class="grid">
            <input type="number" name="age" placeholder="Age" required>
            <input type="number" name="sex" placeholder="Sex (1=Male, 0=Female)" min="0" max="1" required>
            <input type="number" name="cp" placeholder="Chest Pain (0–3)" min="0" max="3" required>
            <input type="number" name="trestbps" placeholder="Resting BP" required>
            <input type="number" name="chol" placeholder="Cholesterol" required>
            <input type="number" name="fbs" placeholder="FBS (1=True, 0=False)" min="0" max="1" required>
            <input type="number" name="restecg" placeholder="Rest ECG (0–2)" min="0" max="2" required>
            <input type="number" name="thalach" placeholder="Max Heart Rate" required>
            <input type="number" name="exang" placeholder="Exercise Angina (1=Yes, 0=No)" min="0" max="1" required>
            <input type="number" step="0.1" name="oldpeak" placeholder="Oldpeak" required>
            <input type="number" name="slope" placeholder="Slope (0–2)" min="0" max="2" required>
            <input type="number" name="ca" placeholder="Major Vessels (0–3)" min="0" max="3" required>
            <input type="number" name="thal" placeholder="Thal (1–3)" min="1" max="3" required>
        </div>

        <button type="submit">Predict Risk</button>
    </form>

    <div id="result"></div>
</div>

<script>
document.getElementById("predictionForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const resultDiv = document.getElementById("result");
    resultDiv.style.display = "block";
    resultDiv.innerHTML = "⏳ Calculating risk...";
    resultDiv.className = "";

    const formData = new FormData(this);
    const response = await fetch("/predict", {
        method: "POST",
        body: formData
    });

    const data = await response.json();

    if (data.error) {
        resultDiv.innerHTML = "❌ Error: " + data.error;
        resultDiv.className = "danger";
        return;
    }

    // Show probability with dynamic color
    const prob = data.probability;
    let riskText = '';
    if (prob >= 70) {
        riskText = `⚠️ High Risk — ${prob}% probability`;
        resultDiv.className = "danger";
    } else if (prob >= 30) {
        riskText = `⚠️ Medium Risk — ${prob}% probability`;
        resultDiv.className = "medium";
    } else {
        riskText = `✅ Low Risk — ${prob}% probability`;
        resultDiv.className = "safe";
    }
    resultDiv.innerHTML = riskText;
});
</script>

</body>
</html>
